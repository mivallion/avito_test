# Тестовое задание для стажера в Market Intelligence.
___
## Описание:
Реализован сервис, позволяющий следить за изменением количества объявлений
в Авито по определённому поисковому запросу и региону. Следит, опрашивая API каждый час, собирает
информацию о количестве объявлений и топе-5 объявлений для каждого запроса+региона, хранящегося в базе.

JSON API сервис написан на FastAPI.

Данные с Авито берутся при помощи API, взятого из мобильного приложения на IOS в результате анализа трафика.

Написаны тесты с помощью библиотеки pytest.

Сервис асинхронно обрабатывает запросы.

Данные хранятся во внешнем хранилище - MongoDB.

Сервер, отвечающий на запросы клиента информацией об объявлениях работает отдельно от сервиса,
занимающегося обновлением этой информации -- они запускаются в разных контейнерах. Однако функции, необходимые им обоим,
вынесены в общий файл common.py, который добавляется в эти контейнеры.
### Методы:
- `/add` -- принимает поисковую фразу и регион(не обязателен), регистрирует их в системе.
Возвращает id пары.
  
- `/stat` -- принимает на вход id пары (фраза-регион) и интервал в виде двух временных меток, за
  который нужно вывести счетчики.
Возвращает счетчики и соответствующие им временные метки (timestamps).
  
- `/top/{query_id}` -- возвращает топ-5 объявлений для заданной пары. Сортировка ведется по количеству
  просмотров объявлений.


### Запуск:
`docker-compose up`


### Недостатки:
- Логин-пароль администратора к базе данных хранятся в коде
- Для использования API Авито необходим ключ приложения, который пока не выяснилось, как получать
  (был использован выданный устройству на IOS)
- В результате опроса слишком большого числа объявлений происходит 403 Forbidden.
- Обращение к БД ведется напрямую, а не через некий промежуточный слой между сервером и MongoDB.